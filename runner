local Players = game:GetService("Players")

local function onPlayerAdded(player)
    player:SetAttribute("Role", "Innocent") -- Varsayılan rol

    player.CharacterAdded:Connect(function(character)
        local humanoidRootPart = character:WaitForChild("HumanoidRootPart")
        local isInvisible = false
        
        while true do
            wait(0.5) -- Kontrol sıklığı

            for _, otherPlayer in ipairs(Players:GetPlayers()) do
                if otherPlayer:GetAttribute("Role") == "Murderer" then
                    local murdererRootPart = otherPlayer.Character and otherPlayer.Character:FindFirstChild("HumanoidRootPart")
                    local knife = otherPlayer.Backpack:FindFirstChild("Knife") -- Bıçak

                    if murdererRootPart and knife then
                        local distance = (murdererRootPart.Position - humanoidRootPart.Position).magnitude

                        -- Eğer "Murderer" 20 birim yakınsa ve bu oyuncu "Innocent" ise
                        if distance < 20 and otherPlayer ~= player then
                            if not isInvisible then
                                isInvisible = true
                                for _, part in ipairs(character:GetChildren()) do
                                    if part:IsA("BasePart") then
                                        part.Transparency = 1 -- Görünmez yap
                                    end
                                end
                            end
                        elseif distance >= 20 and isInvisible then
                            isInvisible = false
                            for _, part in ipairs(character:GetChildren()) do
                                if part:IsA("BasePart") then
                                    part.Transparency = 0 -- Görünür yap
                                end
                            end
                        end
                    end
                end
            end
        end
    end)
end

Players.PlayerAdded:Connect(onPlayerAdded)
